# Activity Summary for 1/25/2026

## 2:50:35 PM
The provided log details changes across two primary files: `FolderList.jsx` and `BookingDetailsButtons.jsx` (which impacts `FolderReview.jsx` indirectly through its data flow).

### File-Specific Updates:

*   **`g:\wamp64\www\sitenettech\api-client\src\pages\backend\Folder\FolderList.jsx`**
    *   **Timestamps:** This file was recorded at multiple points between `1/25/2026, 11:14:23 AM` and `1/25/2026, 2:49:42 PM`.
    *   **Summary:** This component is responsible for displaying a list of "folders" in the backend. It includes functionalities for:
        *   **Data Fetching & Display:** Fetches folder data, handles pagination, sets table headers, and manages UI loading states. It uses `supabase` for data retrieval and real-time updates.
        *   **Folder Creation:** Utilizes `formik` with `folderCreateSchema` for validation to create new folders. Upon creation, it generates a unique `folder_uid` and automatically creates a main passenger and additional unnamed passengers based on the input `folder_no_pax`, then navigates to the folder's edit page.
        *   **Filtering:** Provides extensive filtering options for folders, including date ranges (`created_at`, `updated_at`, `travel_date`), exact matches (UID, order ID, invoice ID, created/updated by, client type, folder status), and text searches. It also supports filtering based on "top summary" counts (e.g., "open", "confirmed", "quoted" folders, "today", "this month").
        *   **Settings & UI:** Manages various UI states such as modals for filtering, settings, and confirmation. It displays top summary counts of different folder statuses.
    *   **Note on Content Duplication:** All provided snippets for this file are identical, suggesting either no functional changes in the visible code section across these timestamps, or changes were in unlogged parts, or the file was simply saved multiple times without modification.

*   **`g:\wamp64\www\sitenettech\api-client\src\components\Backend\Interface\BookingDetails\parts\BookingDetailsButtons.jsx`**
    *   **Timestamp:** `1/25/2026, 12:09:27 PM`.
    *   **Summary:** This component includes the `AddToFolder` function, a critical piece of logic for integrating external booking data into the application's folder structure.
        *   **Folder Creation/Update:** It first checks if a folder linked to the booking's `basketId` already exists. If not, it creates a new folder in the `folders` table, populating it with details from the booking (`folder_uid`, lead passenger info, travel points, travel options, currency, etc.).
        *   **Passenger & Itinerary Insertion:** After creating the folder, it iterates through booking passengers and inserts them into the `passengers` table, mapping their details (e.g., ticket number, name, DOB, passport info). It also processes air segment data (`airsegments`) from the booking, mapping flight details and status codes before inserting them. The log shows a `price` processing logic, but the actual database insertion for `tickets` is truncated.
        *   **Utilities:** Uses helper functions like `getFolderOptions` to determine relevant service types (e.g., ticket, hotel, transfer) from the booking response and `getAirSegmentStatus` to standardize flight status codes.

*   **`g:\wamp64\www\sitenettech\api-client\src\pages\backend\Folder\FolderReview\FolderReview.jsx`**
    *   **Timestamps:** This file was recorded at multiple points between `1/25/2026, 12:26:16 PM` and `1/25/2026, 1:44:22 PM`.
    *   **Summary:** This component is designed for reviewing the details of a specific folder. It focuses on displaying structured booking information.
        *   **Data Loading:** Retrieves folder data either from `location.state` (passed via navigation) or from `sessionStorage` (with an expiry mechanism), indicating a temporary data persistence strategy.
        *   **User & Company Info:** Fetches associated user and company details from `supabase` based on the folder data.
        *   **UI Layout & Interaction:** Manages collapsible sections (`isCollapsed`) and tabbed navigation (`activeTab`, `childActiveTab`) to categorize and display different aspects of the folder, such as Passengers and Itinerary Items (Air Segment, Air Ticket).
        *   **Service Options:** Uses `getFolderOptions` (similar to `BookingDetailsButtons.jsx`) to identify and display the types of services included in the folder.
    *   **Note on Content Duplication:** All provided snippets for this file are identical, suggesting either no functional changes in the visible code section across these timestamps, or changes were in unlogged parts, or the file was simply saved multiple times without modification.

### Timestamps of Significant Changes:

*   The most significant changes, based on differing code content in the provided log, occurred at:
    *   **`1/25/2026, 11:14:23 AM`**: Initial or a major state of `FolderList.jsx`.
    *   **`1/25/2026, 12:09:27 PM`**: Introduction or major update of `BookingDetailsButtons.jsx`, detailing the complex logic for adding booking data to a folder, including passenger and air segment creation.
    *   **`1/25/2026, 12:26:16 PM`**: Initial or a major state of `FolderReview.jsx`.

All other listed timestamps for `FolderList.jsx` and `FolderReview.jsx` show identical code snippets to their first appearance in the log, indicating no new functional changes in the visible sections at those times.

### Patterns and Recurring Elements:

1.  **React Ecosystem:** Consistent use of React functional components, hooks (`useState`, `useEffect`, `useRef`, `useNavigate`, `useLocation`, `useParams`), and external libraries like `formik` for form management.
2.  **Supabase Integration:** Strong reliance on `supabase` for backend interactions (data fetching, insertion, real-time updates) across all listed components.
3.  **UI Component Reusability:** Extensive use of a dedicated `components/UI` directory for common UI elements (Buttons, Modals, Headers, Data Tables, Loaders), indicating a modular and reusable UI architecture.
4.  **Date and Utility Functions:** Frequent use of `dayjs` for date formatting and custom utility functions (`uid`, `today`) from `../../../util/utilityFunction`.
5.  **Centralized Constants:** Configuration and settings are often stored in dedicated constant files (e.g., `../../../constants/Settings/Folder`), promoting maintainability and consistency.
6.  **Iconography:** Consistent usage of `react-icons` for various visual cues across different pages.
7.  **Data Flow Management:** Strategies for managing data flow include props (`propsData` in `FolderReview`), context (`AuthContext`), and `sessionStorage` for temporary persistence.
8.  **Loading and Error States:** Common practice of managing `loading` and `btnLoading` states, and using `Toast` for success/error messages, indicating a focus on user feedback.

## 3:50:33 PM
`g:\wamp64\www\sitenettech\api-client\src\pages\backend\Folder\FolderList.jsx`
Across multiple timestamps from 1/25/2026, 11:14:23 AM to 1/25/2026, 2:49:42 PM, the provided code snippet for this file remains consistently identical. The file appears to be a React component, `FolderList`, responsible for displaying a list of folders, handling their creation, filtering, and settings. It integrates with Supabase for data fetching and real-time updates. It heavily uses `useState`, `useRef`, and `useFormik` for state and form management, along with various UI components and utility functions for tasks like unique ID generation, date formatting, and filter application. Top summary counts are fetched based on folder status and creation date.

`g:\wamp64\www\sitenettech\api-client\src\components\Backend\Interface\BookingDetails\parts\BookingDetailsButtons.jsx`
On 1/25/2026, 12:09:27 PM, this file defines the `BookingDetailsButtons` React component. Its primary function is to facilitate adding booking details into a "folder" system. It checks for an existing folder using the `booking?.basketId` in Supabase. If no folder exists, it creates a new one with a unique UID, user, company, status (defaulting to "open"), lead passenger information, travel points (origin/destination, departure date extracted from flights), booking reference, and a list of `travel_options` (ticket, hotel, transfer, etc.). Subsequently, it inserts individual passenger details and air segment information (including airline, flight number, status, PNR, baggage allowance) into their respective Supabase tables, parsing dates and mapping statuses. The code also initiates complex pricing data construction for passengers, breaking down fares, taxes, commissions, and VAT by passenger type.

`g:\wamp64\www\sitenettech\api-client\src\pages\backend\Folder\FolderReview\FolderReview.jsx`
This React component, `FolderReview`, displays details of a specific folder or booking.

*   **1/25/2026, 12:26:16 PM**: The initial structure involves state management for UI elements (collapse, loading, active tabs) and data (`folderData`, `booking`, `userData`, `travelOption`, `isItineraryData`). It uses `useLocation` to receive initial data via route state and stores/retrieves it from `sessionStorage` with a 5-minute expiry. Utility functions are used for service key mapping and user data fetching from Supabase.
*   **1/25/2026, 12:34:38 PM**: The `today` utility function was added to the import statement from `utilityFunction.js`.
*   **1/25/2026, 12:56:25 PM**: A `pnrRef` (a React ref) was introduced, initialized to `null`.
*   **1/25/2026, 2:55:40 PM**: A new state variable, `isVisible`, was added and initialized to `true`.
*   **1/25/2026, 3:23:02 PM**: The `IoClose` icon was added to the import statement from `react-icons/io5`.
*   **1/25/2026, 3:41:06 PM**: Two new state variables, `pnrInput` and `pnrError`, were introduced to manage input for a PNR (Passenger Name Record) and its validation error. `pnrInput` is initialized from the `air_segment_pnr` of the first air segment in `folderData`.
*   **1/25/2026, 3:41:49 PM**: The initialization logic for `pnrInput` was made more robust by adding optional chaining (`folderData?.airsegments?.[0]`). Crucially, a new `useEffect` hook was added to automatically update the `pnrInput` state whenever `folderData` changes, ensuring the input field reflects the current PNR data from the folder.

**Recurring Patterns:**
*   **Consistent Timestamping:** All changes occur on 1/25/2026, indicating active development on that specific date.
*   **React Hooks Dominance:** Heavy and consistent use of `useState`, `useRef`, and `useEffect` across all React components for managing component state, references, and side effects.
*   **Supabase as Backend:** Both `FolderList.jsx` and `BookingDetailsButtons.jsx` demonstrate strong integration with Supabase for data storage, retrieval, and real-time updates.
*   **Utility Functions:** A set of common utility functions (`uid`, `today`, `formatDate`, etc.) are frequently imported and used, promoting code reuse.
*   **UI Libraries:** `dayjs`, `primereact/toast`, `flowbite-react/Tooltip`, `antd/Dropdown`, and `react-icons` are standard UI/utility library imports, suggesting a cohesive front-end stack.
*   **Modular Design:** Components are broken down into parts (e.g., `FolderCreateBody`, `FolderFilterBody`, `AirSegments`), suggesting a modular application architecture.
*   **Folder-centric Logic:** The majority of changes revolve around the creation, listing, filtering, and detailed review of "folders," which appear to be core entities managing booking or travel information.